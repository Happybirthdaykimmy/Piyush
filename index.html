<!doctype html>
<html lang="en" class="h-full">
 <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Happy Birthday Kimmy</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="/_sdk/element_sdk.js"></script>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Dancing+Script:wght@400;500;600;700&amp;family=Quicksand:wght@300;400;500;600;700&amp;display=swap" rel="stylesheet">
  <style>
    body {
      box-sizing: border-box;
    }
    
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    @keyframes float {
      0%, 100% {
        transform: translateY(0px) translateX(0px) rotate(0deg);
      }
      33% {
        transform: translateY(-30px) translateX(15px) rotate(5deg);
      }
      66% {
        transform: translateY(-15px) translateX(-15px) rotate(-5deg);
      }
    }

    @keyframes float-slow {
      0%, 100% {
        transform: translateY(0px) rotate(0deg);
      }
      50% {
        transform: translateY(-40px) rotate(10deg);
      }
    }

    @keyframes hearts-float {
      0% {
        transform: translateY(100%) scale(0) rotate(0deg);
        opacity: 0;
      }
      10% {
        opacity: 1;
      }
      90% {
        opacity: 1;
      }
      100% {
        transform: translateY(-100%) scale(1.5) rotate(360deg);
        opacity: 0;
      }
    }

    @keyframes sparkle {
      0%, 100% {
        opacity: 0;
        transform: scale(0) rotate(0deg);
      }
      50% {
        opacity: 1;
        transform: scale(1) rotate(180deg);
      }
    }

    @keyframes pulse-glow {
      0%, 100% {
        box-shadow: 0 0 30px rgba(255, 182, 193, 0.8), 0 0 60px rgba(255, 105, 180, 0.6), 0 0 90px rgba(255, 20, 147, 0.4);
        transform: scale(1);
      }
      50% {
        box-shadow: 0 0 50px rgba(255, 182, 193, 1), 0 0 90px rgba(255, 105, 180, 0.8), 0 0 120px rgba(255, 20, 147, 0.6);
        transform: scale(1.03);
      }
    }

    @keyframes petals-fall {
      0% {
        transform: translateY(-20%) translateX(0) rotate(0deg);
        opacity: 1;
      }
      100% {
        transform: translateY(120%) translateX(100px) rotate(360deg);
        opacity: 0;
      }
    }

    @keyframes fade-in-up {
      from {
        opacity: 0;
        transform: translateY(30px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    @keyframes bounce-soft {
      0%, 100% {
        transform: translateY(0);
      }
      50% {
        transform: translateY(-20px);
      }
    }

    @keyframes shimmer {
      0% {
        background-position: -1000px 0;
      }
      100% {
        background-position: 1000px 0;
      }
    }

    @keyframes rotate-glow {
      0% {
        filter: hue-rotate(0deg) brightness(1);
      }
      50% {
        filter: hue-rotate(30deg) brightness(1.2);
      }
      100% {
        filter: hue-rotate(0deg) brightness(1);
      }
    }

    @keyframes scale-pulse {
      0%, 100% {
        transform: scale(1);
      }
      50% {
        transform: scale(1.05);
      }
    }

    @keyframes text-glow {
      0%, 100% {
        text-shadow: 0 0 10px rgba(255, 255, 255, 0.5), 0 0 20px rgba(255, 182, 193, 0.5), 0 0 30px rgba(255, 105, 180, 0.5);
      }
      50% {
        text-shadow: 0 0 20px rgba(255, 255, 255, 0.8), 0 0 40px rgba(255, 182, 193, 0.8), 0 0 60px rgba(255, 105, 180, 0.8);
      }
    }

    @keyframes balloon-float {
      0%, 100% {
        transform: translateY(0) rotate(-5deg);
      }
      50% {
        transform: translateY(-20px) rotate(5deg);
      }
    }

    @keyframes balloon-pop {
      0% {
        transform: scale(1);
        opacity: 1;
      }
      50% {
        transform: scale(1.3);
        opacity: 0.7;
      }
      100% {
        transform: scale(0);
        opacity: 0;
      }
    }

    .float {
      animation: float 8s ease-in-out infinite;
    }

    .float-slow {
      animation: float-slow 10s ease-in-out infinite;
    }

    .hearts-float {
      animation: hearts-float 8s linear infinite;
    }

    .sparkle {
      animation: sparkle 2s ease-in-out infinite;
    }

    .pulse-glow {
      animation: pulse-glow 3s ease-in-out infinite;
    }

    .petals-fall {
      animation: petals-fall 12s linear infinite;
    }

    .fade-in-up {
      animation: fade-in-up 1s ease-out forwards;
    }

    .bounce-soft {
      animation: bounce-soft 3s ease-in-out infinite;
    }

    .shimmer-effect {
      background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.4), transparent);
      background-size: 200% 100%;
      animation: shimmer 3s infinite;
    }

    .rotate-glow {
      animation: rotate-glow 4s ease-in-out infinite;
    }

    .scale-pulse {
      animation: scale-pulse 2s ease-in-out infinite;
    }

    .text-glow {
      animation: text-glow 3s ease-in-out infinite;
    }

    .balloon {
      cursor: pointer;
      transition: transform 0.2s ease;
      animation: balloon-float 3s ease-in-out infinite;
    }

    .balloon:hover {
      transform: scale(1.1);
    }

    .balloon.popped {
      animation: balloon-pop 0.4s ease-out forwards;
      pointer-events: none;
    }

    .photo-frame {
      position: relative;
      overflow: hidden;
      border-radius: 25px;
      box-shadow: 0 15px 50px rgba(255, 105, 180, 0.4), 0 0 30px rgba(255, 20, 147, 0.3);
      transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
      background: linear-gradient(135deg, #fff 0%, #ffe6f0 100%);
      padding: 20px;
    }

    .photo-frame::before {
      content: '';
      position: absolute;
      top: -50%;
      left: -50%;
      width: 200%;
      height: 200%;
      background: linear-gradient(45deg, transparent, rgba(255, 255, 255, 0.3), transparent);
      transform: rotate(45deg);
      animation: shimmer 3s infinite;
    }

    .photo-frame:hover {
      transform: translateY(-15px) rotate(3deg) scale(1.05);
      box-shadow: 0 25px 70px rgba(255, 105, 180, 0.6), 0 0 50px rgba(255, 20, 147, 0.5);
    }

    .photo-placeholder {
      width: 100%;
      height: 100%;
      background: linear-gradient(135deg, #ffe6f0 0%, #ffc9dd 50%, #ffb3d9 100%);
      display: flex;
      align-items: center;
      justify-content: center;
      border-radius: 16px;
      font-size: 4rem;
    }

    .message-card {
      background: rgba(255, 255, 255, 0.3);
      backdrop-filter: blur(25px);
      border: 3px solid rgba(255, 255, 255, 0.5);
      border-radius: 35px;
      padding: 50px;
      box-shadow: 0 20px 60px rgba(255, 105, 180, 0.3), 0 0 40px rgba(255, 182, 193, 0.2);
      position: relative;
      overflow: hidden;
    }

    .message-card::before {
      content: '';
      position: absolute;
      top: -50%;
      left: -50%;
      width: 200%;
      height: 200%;
      background: linear-gradient(45deg, transparent, rgba(255, 255, 255, 0.2), transparent);
      transform: rotate(45deg);
      animation: shimmer 4s infinite;
    }

    .gradient-text {
      background: linear-gradient(135deg, #ff69b4 0%, #ff1493 30%, #ff69b4 50%, #c71585 70%, #ff1493 100%);
      background-size: 200% auto;
      -webkit-background-clip: text;
      background-clip: text;
      -webkit-text-fill-color: transparent;
      animation: shimmer 3s linear infinite;
    }
  </style>
  <style>@view-transition { navigation: auto; }</style>
  <script src="/_sdk/data_sdk.js" type="text/javascript"></script>
 </head>
 <body class="h-full">
  <div id="app-container" class="h-full w-full overflow-hidden relative" style="background: radial-gradient(circle at 20% 30%, #ffb3d9 0%, transparent 50%), radial-gradient(circle at 80% 70%, #ffa6d5 0%, transparent 50%), linear-gradient(180deg, #ffc9dd 0%, #ffb3d9 25%, #ffa6d5 50%, #ff9ed1 75%, #ff91cc 100%);"><!-- No floating balloons on this screen to avoid confusion --> <!-- Floating Hearts -->
   <div class="absolute inset-0 overflow-hidden pointer-events-none">
    <div class="absolute text-4xl hearts-float" style="left: 10%; animation-delay: 0s;">
     ğŸ’•
    </div>
    <div class="absolute text-3xl hearts-float" style="left: 25%; animation-delay: -2s;">
     ğŸ’–
    </div>
    <div class="absolute text-4xl hearts-float" style="left: 45%; animation-delay: -4s;">
     ğŸ’—
    </div>
    <div class="absolute text-3xl hearts-float" style="left: 65%; animation-delay: -1s;">
     ğŸ’•
    </div>
    <div class="absolute text-4xl hearts-float" style="left: 80%; animation-delay: -3s;">
     ğŸ’–
    </div>
    <div class="absolute text-3xl hearts-float" style="left: 90%; animation-delay: -5s;">
     ğŸ’—
    </div>
    <div class="absolute text-3xl hearts-float" style="left: 15%; animation-delay: -6s;">
     ğŸ’“
    </div>
    <div class="absolute text-4xl hearts-float" style="left: 55%; animation-delay: -7s;">
     ğŸ’
    </div>
   </div><!-- Falling Petals -->
   <div class="absolute inset-0 overflow-hidden pointer-events-none">
    <div class="absolute text-3xl petals-fall" style="left: 5%; animation-delay: 0s;">
     ğŸŒ¸
    </div>
    <div class="absolute text-3xl petals-fall" style="left: 15%; animation-delay: -3s;">
     ğŸŒ¸
    </div>
    <div class="absolute text-3xl petals-fall" style="left: 25%; animation-delay: -6s;">
     ğŸŒ¸
    </div>
    <div class="absolute text-3xl petals-fall" style="left: 35%; animation-delay: -2s;">
     ğŸŒ¸
    </div>
    <div class="absolute text-3xl petals-fall" style="left: 45%; animation-delay: -8s;">
     ğŸŒ¸
    </div>
    <div class="absolute text-3xl petals-fall" style="left: 55%; animation-delay: -5s;">
     ğŸŒ¸
    </div>
    <div class="absolute text-3xl petals-fall" style="left: 65%; animation-delay: -10s;">
     ğŸŒ¸
    </div>
    <div class="absolute text-3xl petals-fall" style="left: 75%; animation-delay: -1s;">
     ğŸŒ¸
    </div>
    <div class="absolute text-3xl petals-fall" style="left: 85%; animation-delay: -7s;">
     ğŸŒ¸
    </div>
    <div class="absolute text-3xl petals-fall" style="left: 95%; animation-delay: -4s;">
     ğŸŒ¸
    </div>
    <div class="absolute text-3xl petals-fall" style="left: 10%; animation-delay: -9s;">
     ğŸŒº
    </div>
    <div class="absolute text-3xl petals-fall" style="left: 30%; animation-delay: -11s;">
     ğŸŒº
    </div>
    <div class="absolute text-3xl petals-fall" style="left: 50%; animation-delay: -2.5s;">
     ğŸŒº
    </div>
    <div class="absolute text-3xl petals-fall" style="left: 70%; animation-delay: -6.5s;">
     ğŸŒº
    </div>
    <div class="absolute text-3xl petals-fall" style="left: 90%; animation-delay: -12s;">
     ğŸŒº
    </div>
   </div><!-- Sparkles -->
   <div class="absolute inset-0 overflow-hidden pointer-events-none">
    <div class="absolute w-4 h-4 bg-white rounded-full sparkle" style="top: 15%; left: 20%; animation-delay: 0s; box-shadow: 0 0 10px #fff;"></div>
    <div class="absolute w-3 h-3 bg-white rounded-full sparkle" style="top: 35%; left: 70%; animation-delay: 0.5s; box-shadow: 0 0 8px #fff;"></div>
    <div class="absolute w-4 h-4 bg-white rounded-full sparkle" style="top: 55%; left: 30%; animation-delay: 1s; box-shadow: 0 0 10px #fff;"></div>
    <div class="absolute w-3 h-3 bg-white rounded-full sparkle" style="top: 75%; left: 80%; animation-delay: 1.5s; box-shadow: 0 0 8px #fff;"></div>
    <div class="absolute w-4 h-4 bg-white rounded-full sparkle" style="top: 25%; left: 50%; animation-delay: 0.7s; box-shadow: 0 0 10px #fff;"></div>
    <div class="absolute w-3 h-3 bg-white rounded-full sparkle" style="top: 65%; left: 60%; animation-delay: 1.2s; box-shadow: 0 0 8px #fff;"></div>
    <div class="absolute w-4 h-4 bg-white rounded-full sparkle" style="top: 45%; left: 15%; animation-delay: 0.3s; box-shadow: 0 0 10px #fff;"></div>
    <div class="absolute w-3 h-3 bg-white rounded-full sparkle" style="top: 85%; left: 40%; animation-delay: 1.8s; box-shadow: 0 0 8px #fff;"></div>
    <div class="absolute w-4 h-4 bg-white rounded-full sparkle" style="top: 10%; left: 85%; animation-delay: 0.9s; box-shadow: 0 0 10px #fff;"></div>
    <div class="absolute w-3 h-3 bg-white rounded-full sparkle" style="top: 50%; left: 90%; animation-delay: 1.4s; box-shadow: 0 0 8px #fff;"></div>
   </div><!-- Screens Container -->
   <div class="relative z-10 w-full h-full"><!-- Screen 1: Name & First Message -->
    <section id="screen-1" class="screen-slide absolute inset-0 flex flex-col items-center justify-center px-6">
     <div class="text-center max-w-4xl fade-in-up"><!-- Decorative Stars -->
      <div class="mb-8 flex justify-center gap-8">
       <div class="text-6xl bounce-soft scale-pulse" style="animation-delay: 0s; filter: drop-shadow(0 0 15px rgba(255, 223, 0, 0.8));">
        â­
       </div>
       <div class="text-7xl bounce-soft scale-pulse" style="animation-delay: 0.5s; filter: drop-shadow(0 0 20px rgba(255, 105, 180, 0.8));">
        ğŸ’–
       </div>
       <div class="text-6xl bounce-soft scale-pulse" style="animation-delay: 1s; filter: drop-shadow(0 0 15px rgba(255, 223, 0, 0.8));">
        â­
       </div>
      </div><!-- Name -->
      <h1 id="main-name" class="text-7xl md:text-9xl font-bold mb-6 gradient-text text-glow" style="font-family: 'Dancing Script', cursive;">Kimmy</h1>
      <p id="nickname" class="text-4xl md:text-5xl mb-12 text-glow" style="font-family: 'Quicksand', sans-serif; color: #ffffff; font-weight: 500; text-shadow: 0 0 15px rgba(255, 255, 255, 0.6), 0 0 30px rgba(255, 182, 193, 0.5), 2px 2px 8px rgba(0,0,0,0.2);">Bhonduuuuu ğŸ’•</p><!-- First Romantic Message -->
      <div class="message-card mb-12 fade-in-up" style="animation-delay: 0.5s;">
       <p id="first-message" class="text-2xl md:text-3xl leading-relaxed" style="font-family: 'Quicksand', sans-serif; color: #8b0051; font-weight: 500; font-style: italic;">"You were Sapovnelaâ€”lost to the world, hidden in silenceâ€¦ until my soul recognized you."</p>
      </div><!-- Tap to continue -->
      <div class="text-center mt-8 animate-bounce">
       <p class="text-xl" style="font-family: 'Quicksand', sans-serif; color: #ffffff; font-weight: 600;">Tap anywhere to continue âœ¨</p>
      </div>
     </div>
    </section><!-- Screen 2: Balloon Pop Reveal -->
    <section id="screen-2" class="screen-slide absolute inset-0 flex flex-col items-center justify-center px-6 opacity-0 pointer-events-none">
     <div class="text-center max-w-4xl">
      <p class="text-2xl mb-12 animate-bounce" style="font-family: 'Quicksand', sans-serif; color: #ffffff; font-weight: 600;">Tap the balloons to pop them! ğŸˆ</p><!-- Balloons Grid -->
      <div id="balloons-container" class="grid grid-cols-3 md:grid-cols-4 gap-6 mb-12"><!-- Balloons will be generated by JavaScript -->
      </div><!-- Hidden Message (revealed after all balloons pop) -->
      <div id="balloon-reveal" class="opacity-0 pointer-events-none transition-all duration-1000">
       <h2 class="text-5xl md:text-7xl font-bold mb-6 gradient-text text-glow" style="font-family: 'Dancing Script', cursive;">Happy Birthday ğŸ‰</h2>
       <h3 class="text-6xl md:text-8xl font-bold mb-4 gradient-text text-glow" style="font-family: 'Dancing Script', cursive;">Kimmy</h3>
       <p class="text-4xl md:text-5xl mb-8" style="font-family: 'Quicksand', sans-serif; color: #ffffff; font-weight: 500; text-shadow: 0 0 15px rgba(255, 255, 255, 0.6), 0 0 30px rgba(255, 182, 193, 0.5);">Bhonduuuu ğŸ’•</p>
       <div class="text-center mt-8 animate-bounce">
        <p class="text-xl" style="font-family: 'Quicksand', sans-serif; color: #ffffff; font-weight: 600;">Tap to see photos ğŸ“¸</p>
       </div>
      </div>
     </div>
    </section><!-- Screen 3: Photo Gallery -->
    <section id="screen-3" class="screen-slide absolute inset-0 flex flex-col items-center justify-center px-6 py-12 overflow-auto opacity-0 pointer-events-none">
     <div class="max-w-6xl mx-auto">
      <h2 class="text-5xl md:text-6xl font-bold text-center mb-12" style="font-family: 'Dancing Script', cursive; color: #ffffff; text-shadow: 3px 3px 10px rgba(0,0,0,0.2);">Beautiful Moments ğŸ“¸</h2>
      <div class="grid grid-cols-1 md:grid-cols-2 gap-8 mb-8"><!-- Photo 1 -->
       <div class="photo-frame fade-in-up" style="animation-delay: 0.2s;">
        <div id="photo-1-container" class="photo-placeholder aspect-square">
         ğŸ’
        </div>
       </div><!-- Photo 2 -->
       <div class="photo-frame fade-in-up" style="animation-delay: 0.4s;">
        <div id="photo-2-container" class="photo-placeholder aspect-square">
         ğŸ’
        </div>
       </div><!-- Photo 3 -->
       <div class="photo-frame fade-in-up" style="animation-delay: 0.6s;">
        <div id="photo-3-container" class="photo-placeholder aspect-square">
         ï¿½ï¿½ï¿½
        </div>
       </div><!-- Cat Photo -->
       <div class="photo-frame fade-in-up" style="animation-delay: 0.8s;">
        <div id="cat-photo-container" class="photo-placeholder aspect-square">
         ğŸ±ğŸ’•
        </div>
       </div>
      </div><!-- Tap to continue -->
      <div class="text-center mt-8 animate-bounce">
       <p class="text-xl" style="font-family: 'Quicksand', sans-serif; color: #ffffff; font-weight: 600;">Tap for birthday message ğŸ‚</p>
      </div>
     </div>
    </section><!-- Screen 4: Birthday Message -->
    <section id="screen-4" class="screen-slide absolute inset-0 flex flex-col items-center justify-center px-6 opacity-0 pointer-events-none">
     <div class="max-w-4xl mx-auto text-center">
      <div class="message-card fade-in-up">
       <div class="mb-8">
        <div class="text-6xl mb-6">
         ğŸ‚
        </div>
        <h2 class="text-4xl md:text-5xl font-bold mb-8 gradient-text" style="font-family: 'Dancing Script', cursive;">Happy Birthday!</h2>
       </div>
       <p id="birthday-message" class="text-xl md:text-2xl leading-relaxed mb-6" style="font-family: 'Quicksand', sans-serif; color: #8b0051; font-weight: 500;">Hope your birthday brings you smiles, calm moments, and all the good things you deserve, my loveğŸ’Œ. I'm really glad it's you I get to wish today.<br><br>
        Happy Birthday, Kimmy ğŸ’•</p>
       <div class="text-6xl mt-8"><span class="inline-block scale-pulse" style="animation-delay: 0s; filter: drop-shadow(0 0 10px rgba(255, 182, 193, 0.8));">ğŸ‰</span> <span class="inline-block scale-pulse" style="animation-delay: 0.3s; filter: drop-shadow(0 0 10px rgba(255, 223, 0, 0.8));">âœ¨</span> <span class="inline-block scale-pulse" style="animation-delay: 0.6s; filter: drop-shadow(0 0 10px rgba(255, 105, 180, 0.8));">ğŸˆ</span>
       </div>
      </div>
      <div class="text-center mt-12">
       <p class="text-2xl" style="font-family: 'Quicksand', sans-serif; color: #ffffff; font-weight: 500; text-shadow: 2px 2px 6px rgba(0,0,0,0.2);">With all my love ğŸ’–</p>
      </div>
     </div>
    </section>
   </div>
  </div>
  <script>
    // Default configuration
    const defaultConfig = {
      main_name: 'Kimmy',
      nickname: 'Bhonduuuu ğŸ’•',
      first_message: '"You were Sapovnelaâ€”lost to the world, hidden in silenceâ€¦ until my soul recognized you."',
      birthday_message: "Hope your birthday brings you smiles, calm moments, and all the good things you deserve, my loveğŸ’Œ. I'm really glad it's you I get to wish today.\n\nHappy Birthday, Kimmy ğŸ’•",
      photo_1: '/photo_1.jpg',
      photo_2: '/photo_2.jpg',
      photo_3: '/photo_3.jpg',
      cat_photo: '/cat_photo.jpg',
      background_gradient_start: '#ffc9dd',
      background_gradient_end: '#ff91cc',
      primary_color: '#ff69b4',
      text_color: '#8b0051',
      accent_color: '#ffffff',
      font_family: 'Quicksand',
      font_size: 16
    };

    // DOM Elements
    const mainName = document.getElementById('main-name');
    const nickname = document.getElementById('nickname');
    const firstMessage = document.getElementById('first-message');
    const birthdayMessage = document.getElementById('birthday-message');

    const screens = [
      document.getElementById('screen-1'),
      document.getElementById('screen-2'),
      document.getElementById('screen-3'),
      document.getElementById('screen-4')
    ];

    let currentScreen = 0;
    let balloonsPopped = 0;
    const totalBalloons = 13; // H-A-P-P-Y B-I-R-T-H-D-A-Y

    // Generate balloons
    function createBalloons() {
      const container = document.getElementById('balloons-container');
      const balloonTexts = [
        'H', 'A', 'P', 'P', 'Y',
        'B', 'I', 'R', 'T', 'H',
        'D', 'A', 'Y'
      ];
      
      balloonTexts.forEach((text, index) => {
        const balloonWrapper = document.createElement('div');
        balloonWrapper.className = 'balloon relative text-center';
        balloonWrapper.style.animationDelay = `${index * 0.1}s`;
        balloonWrapper.style.filter = 'drop-shadow(0 0 15px rgba(255, 105, 180, 0.6))';
        balloonWrapper.style.cursor = 'pointer';
        
        const balloonEmoji = document.createElement('div');
        balloonEmoji.className = 'text-7xl';
        balloonEmoji.textContent = 'ğŸˆ';
        
        const balloonText = document.createElement('div');
        balloonText.className = 'absolute inset-0 flex items-center justify-center text-white font-bold text-2xl pointer-events-none';
        balloonText.style.fontFamily = "'Quicksand', sans-serif";
        balloonText.style.textShadow = '2px 2px 4px rgba(0,0,0,0.5)';
        balloonText.textContent = text;
        balloonText.style.top = '-5px';
        
        balloonWrapper.appendChild(balloonEmoji);
        balloonWrapper.appendChild(balloonText);
        
        balloonWrapper.addEventListener('click', function() {
          if (!this.classList.contains('popped')) {
            this.classList.add('popped');
            balloonsPopped++;
            
            // Check if all balloons are popped
            if (balloonsPopped === totalBalloons) {
              setTimeout(() => {
                const reveal = document.getElementById('balloon-reveal');
                reveal.style.opacity = '1';
                reveal.style.pointerEvents = 'auto';
              }, 500);
            }
          }
        });
        
        container.appendChild(balloonWrapper);
      });
    }

    // Screen transition
    function goToNextScreen() {
      if (currentScreen < screens.length - 1) {
        // Hide current screen
        screens[currentScreen].style.opacity = '0';
        screens[currentScreen].style.pointerEvents = 'none';
        screens[currentScreen].style.transition = 'opacity 0.5s ease-out';

        currentScreen++;

        // Show next screen
        screens[currentScreen].style.opacity = '1';
        screens[currentScreen].style.pointerEvents = 'auto';
        screens[currentScreen].style.transition = 'opacity 0.5s ease-in';

        // Create balloons when entering screen 2
        if (currentScreen === 1 && balloonsPopped === 0) {
          createBalloons();
        }
      }
    }

    // Add click handlers
    screens[0].addEventListener('click', goToNextScreen);
    
    // Screen 2: Only allow clicking the reveal message, not the entire screen
    document.getElementById('balloon-reveal').addEventListener('click', function(e) {
      if (this.style.opacity === '1') {
        e.stopPropagation();
        goToNextScreen();
      }
    });

    // Handler for photo screen
    screens[2].addEventListener('click', goToNextScreen);

    // Load image into container
    function loadImage(url, containerId) {
      const container = document.getElementById(containerId);
      if (!url || url.trim() === '') {
        // Keep placeholder
        return;
      }

      const img = document.createElement('img');
      img.src = url.trim();
      img.alt = 'Photo';
      img.loading = 'lazy';
      img.style.width = '100%';
      img.style.height = '100%';
      img.style.objectFit = 'cover';
      img.style.borderRadius = '12px';
      
      img.onerror = function() {
        this.src = '';
        this.alt = 'Image failed to load';
        this.style.display = 'none';
      };

      img.onload = function() {
        container.innerHTML = '';
        container.appendChild(img);
      };
    }

    // Config change handler
    async function onConfigChange(config) {
      const name = config.main_name || defaultConfig.main_name;
      const nick = config.nickname || defaultConfig.nickname;
      const firstMsg = config.first_message || defaultConfig.first_message;
      const birthdayMsg = config.birthday_message || defaultConfig.birthday_message;
      const fontFamily = config.font_family || defaultConfig.font_family;
      const fontSize = config.font_size || defaultConfig.font_size;

      // Update text content
      mainName.textContent = name;
      nickname.textContent = nick;
      firstMessage.textContent = firstMsg;
      birthdayMessage.textContent = birthdayMsg;

      // Update fonts
      mainName.style.fontFamily = `'Dancing Script', ${fontFamily}, cursive`;
      nickname.style.fontFamily = `${fontFamily}, sans-serif`;
      firstMessage.style.fontFamily = `${fontFamily}, sans-serif`;
      birthdayMessage.style.fontFamily = `${fontFamily}, sans-serif`;

      // Update font sizes
      mainName.style.fontSize = `${fontSize * 5.5}px`;
      nickname.style.fontSize = `${fontSize * 3}px`;
      firstMessage.style.fontSize = `${fontSize * 1.75}px`;
      birthdayMessage.style.fontSize = `${fontSize * 1.5}px`;

      // Load images
      loadImage(config.photo_1 || defaultConfig.photo_1, 'photo_1.jpg','photo-1-container');
      loadImage(config.photo_2 || defaultConfig.photo_2, 'photo_2.jpg','photo-2-container');
      loadImage(config.photo_3 || defaultConfig.photo_3, 'photo_3.jpg','photo-3-container');
      loadImage(config.cat_photo || defaultConfig.cat_photo, 'cat_photo.jpg','cat-photo-container');
    }

    // Map to capabilities
    function mapToCapabilities(config) {
      return {
        recolorables: [],
        borderables: [],
        fontEditable: {
          get: () => config.font_family || defaultConfig.font_family,
          set: (value) => {
            config.font_family = value;
            window.elementSdk.setConfig({ font_family: value });
          }
        },
        fontSizeable: {
          get: () => config.font_size || defaultConfig.font_size,
          set: (value) => {
            config.font_size = value;
            window.elementSdk.setConfig({ font_size: value });
          }
        }
      };
    }

    // Map to edit panel values
    function mapToEditPanelValues(config) {
      return new Map([
        ['main_name', config.main_name || defaultConfig.main_name],
        ['nickname', config.nickname || defaultConfig.nickname],
        ['first_message', config.first_message || defaultConfig.first_message],
        ['birthday_message', config.birthday_message || defaultConfig.birthday_message],
        ['photo_1', config.photo_1 || defaultConfig.photo_1],
        ['photo_2', config.photo_2 || defaultConfig.photo_2],
        ['photo_3', config.photo_3 || defaultConfig.photo_3],
        ['cat_photo', config.cat_photo || defaultConfig.cat_photo]
      ]);
    }

    // Initialize SDK
   onConfigChange(defaultConfig);
    if (window.elementSdk) {
      window.elementSdk.init({
        defaultConfig,
        onConfigChange,
        mapToCapabilities,
        mapToEditPanelValues
      });
    }
  </script>
 <script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'9bfcd6cbe08147c5',t:'MTc2ODcyNjE2Ni4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
